---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const posts = (await getCollection('library')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const statusColors = {
  seed: 'bg-amber-50 text-amber-700 border border-amber-200/50',
  sapling: 'bg-emerald-50 text-emerald-700 border border-emerald-200/50',
  evergreen: 'bg-sky-50 text-sky-700 border border-sky-200/50',
};
---

<BaseLayout
  title="Library - Zen X Hunger"
  description="Book reviews, reading reflections, and interdisciplinary explorations"
>
  <div class="max-w-7xl mx-auto px-6 sm:px-8 lg:px-12 py-20">
    <!-- Header -->
    <header class="mb-16">
      <nav class="mb-8 text-sm text-stone-600 font-light">
        <a href="/" class="hover:text-emerald-700 transition-all duration-200">Home</a>
        <span class="mx-2 text-stone-400">/</span>
        <span class="text-stone-900">Library</span>
      </nav>

      <div class="space-y-4">
        <h1 class="text-5xl sm:text-6xl font-semibold text-stone-900 tracking-tight">
          Library
        </h1>
        <p class="text-xl text-stone-600 max-w-3xl font-light leading-relaxed">
          Book reviews, reading reflections, and interdisciplinary explorations.
          Capturing thoughts on literature, ideas, and the connections between them.
        </p>
      </div>
    </header>

    <!-- Posts Grid -->
    {posts.length > 0 ? (
      <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {posts.map((post) => (
          <article class="group bg-white rounded-xl border border-stone-200/80 p-7 hover:shadow-xl hover:shadow-stone-200/50 hover:border-stone-300/80 hover:-translate-y-1 transition-all duration-300">
            <div class="flex items-center gap-2.5 mb-4">
              <span class={`text-xs font-medium px-3 py-1 rounded-full ${statusColors[post.data.status]}`}>
                {post.data.status}
              </span>
              <time class="text-xs text-stone-500 font-light">
                {post.data.pubDate.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'short',
                  day: 'numeric'
                })}
              </time>
            </div>

            <h2 class="text-xl font-semibold text-stone-900 mb-3 line-clamp-2 group-hover:text-emerald-700 transition-colors duration-200">
              <a href={`/library/${post.slug}`}>
                {post.data.title}
              </a>
            </h2>

            <p class="text-sm text-stone-600 leading-relaxed mb-5 line-clamp-3 font-light">
              {post.data.description}
            </p>

            <div class="flex flex-wrap gap-2 mb-5">
              {post.data.tags.slice(0, 4).map((tag) => (
                <span class="text-xs text-stone-500 bg-stone-100/80 px-2.5 py-1 rounded-md font-light">
                  #{tag}
                </span>
              ))}
            </div>

            <a
              href={`/library/${post.slug}`}
              class="inline-flex items-center text-sm font-medium text-stone-700 hover:text-emerald-700 transition-all duration-200 group/link"
            >
              Read more
              <svg class="w-4 h-4 ml-1 transform group-hover/link:translate-x-1 transition-transform duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          </article>
        ))}
      </div>
    ) : (
      <div class="text-center py-20">
        <p class="text-stone-500 text-lg mb-2 font-light">No posts yet.</p>
        <p class="text-stone-400 text-sm font-light">Start sharing your reading journey and reflections!</p>
      </div>
    )}
  </div>
</BaseLayout>
